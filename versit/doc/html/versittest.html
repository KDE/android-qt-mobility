<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- ./examples/sampleversit.qdoc -->
<head>
  <title>Sample Versit Example</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qtlogo.png" align="left" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a></td>
<td align="right" valign="top" width="230"><img src="images/codeless.png"  border="0" /></td></tr></table><h1 class="title">Sample Versit Example<br /><span class="subtitle"></span>
</h1>
<p>Files:</p>
<ul>
<li><a href="versittest-testconfiguration-cpp.html">versittest/testconfiguration.cpp</a></li>
<li><a href="versittest-testconfiguration-h.html">versittest/testconfiguration.h</a></li>
<li><a href="versittest-testresultxmlparser-cpp.html">versittest/testresultxmlparser.cpp</a></li>
<li><a href="versittest-testresultxmlparser-h.html">versittest/testresultxmlparser.h</a></li>
<li><a href="versittest-vcardcomparator-cpp.html">versittest/vcardcomparator.cpp</a></li>
<li><a href="versittest-vcardcomparator-h.html">versittest/vcardcomparator.h</a></li>
<li><a href="versittest-versittest-cpp.html">versittest/versittest.cpp</a></li>
<li><a href="versittest-versittest-h.html">versittest/versittest.h</a></li>
<li><a href="versittest-versittestconfig-xml.html">versittest/versittestconfig.xml</a></li>
<li><a href="versittest-main-cpp.html">versittest/main.cpp</a></li>
<li><a href="versittest-versittest-pro.html">versittest/versittest.pro</a></li>
</ul>
<ul><li><a href="#versit">Versit</a></li>
<ul><li><a href="#motivation">Motivation</a></li>
<li><a href="#use-case">Use Case</a></li>
<li><a href="#interface">Interface</a></li>
<li><a href="#code-snippets">Code snippets</a></li>
<li><a href="#known-issues">Known Issues</a></li>
</ul>
</ul>
<a name="versit"></a>
<h2>Versit</h2>
<p>This example shows how to use <a href="#versit">Versit API</a>.</p>
<a name="motivation"></a>
<h3>Motivation</h3>
<p>This application was written to provide an example to developers of how to use the Qt Versit API. It uses the <a href="http://qt.nokia.com/doc/4.5/qttest.html">QTTest</a> framework to intialize some tests and call the needed function. But the main motivation is how to convert VCard formatted file into QContact and save into contact database. Also to convert it back ( QContact to VCard file ) and compare the input vcard file with output vcard file.Interestingly you could notice that in some cases unsupported vcard fields were missed in output file. That may give some insight about to find out unsupported field by QContact. Also check <a href="versitmapping.html">Qt Versit Mapping</a> to know how VCard field are mapped to QContact details.</p>
<p>[*] <i>vCard is a registered trademark of the Internet Mail Consortium</i></p>
<a name="use-case"></a>
<h3>Use Case</h3>
<p>There are applications like Sync and Backup used to import vards into phonebook contacts or export contacts into vcard formatted file which can be stored in memory card or send as business card via Email/Bluetooth/Infrared etc.</p>
<p>So the Sync and Backup application developers can write a code as mentioned in this sample to generate QContact from vcard formatted file or generate vcard from QContact.</p>
<a name="interface"></a>
<h3>Interface</h3>
<p>The application is aimed at desktop platforms as opposed to mobile platforms. So the whole versit code is developed by using QT libraries and it does not have any dependencies to platform specific implementations.</p>
<a name="code-snippets"></a>
<h3>Code snippets</h3>
<p>Following snippets will be usable to API users like Sync/Backup developers.</p>
<pre>    void VersitTest::executeTest(QFile&amp; in, QIODevice&amp; out)
    {
        in.seek(0);
        mReader-&gt;setDevice(&amp;in);
        out.reset();
        mWriter-&gt;setDevice(&amp;out);

        <span class="comment">// Parse the input</span>
        QVERIFY2(mReader-&gt;readAll(),in.fileName().toAscii().constData());

        <span class="comment">// Convert to QContacts</span>
        QList&lt;QContact&gt; contacts;
        QList&lt;QVersitDocument::VersitType&gt; documentTypes;
        foreach (QVersitDocument document, mReader-&gt;result()) {
            mImporter-&gt;setImagePath(mImageAndAudioClipPath);
            mImporter-&gt;setAudioClipPath(mImageAndAudioClipPath);
            QContact contact = mImporter-&gt;importContact(document);
            if (mSaveContacts)
                QVERIFY(mContactManager-&gt;saveContact(&amp;contact));
            contacts.append(contact);
            documentTypes.append(document.versitType());
        }

        <span class="comment">// Convert back to QVersitDocuments</span>
        QList&lt;QVersitDocument&gt; documents;
        connect(mExporter, SIGNAL(scale(const QString&amp;,QByteArray&amp;)),
                this, SLOT(scale(const QString&amp;,QByteArray&amp;)));

        foreach (QContact contact, contacts) {
            QVersitDocument document = mExporter-&gt;exportContact(contact);
            if (!documentTypes.isEmpty())
                document.setVersitType(documentTypes.takeFirst());
            documents.append(document);
        }

        <span class="comment">// Encode and write to output</span>
        foreach (QVersitDocument document, documents) {
            mWriter-&gt;setVersitDocument(document);
            QVERIFY2(mWriter-&gt;writeAll(),in.fileName().toAscii().constData());
        }
    }</pre>
<a name="known-issues"></a>
<h3>Known Issues</h3>
<p>Only VCard 2.1 version is fully supported</p>
<p>Furthermore:</p>
<ul>
<li>Unsupported X-Fields are not mapped to QContactDetail</li>
</ul>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
<td align="right"><div align="right">Qt Contacts</div></td>
</tr></table></div></address></body>
</html>
