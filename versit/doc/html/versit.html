<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- ../../doc/src/versit.qdoc -->
<head>
  <title>Qt Versit Developer Resources</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qtlogo.png" align="left" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a></td>
<td align="right" valign="top" width="230"><img src="images/codeless.png"  border="0" /></td></tr></table><h1 class="title">Qt Versit Developer Resources<br /><span class="subtitle"></span>
</h1>
<ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#using-the-api">Using the API</a></li>
<ul><li><a href="#generating-qcontact-from-vcard-file">Generating QContact from VCard file</a></li>
<li><a href="#generating-vcard-file-from-qcontact">Generating VCard file from QContact</a></li>
<li><a href="#generating-vcard-file-from-qcontact-and-save-to-contact-database">Generating VCard file from QContact and save to contact database</a></li>
</ul>
<li><a href="#building-and-compiling">Building and compiling</a></li>
<li><a href="#reference-documentation">Reference documentation</a></li>
<ul><li><a href="#main-classes">Main classes</a></li>
<li><a href="#asynchronous-requests">Asynchronous Requests</a></li>
<li><a href="#examples">Examples</a></li>
</ul>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>QT Versit API provides a set of methods to parse VCard 2.1 ( As mentioned in www.imc.org/pdi/vcard-21.rtf specification ) formatted content. Also it provides utlitiy style of API to generate QContact from the VCard 2.1 input stream and also in other way from QContact to VCard 2.1 output stream. The whole parser is platform independent from the perspective of Qt-based, cross-platform development.</p>
<a name="overview"></a>
<h2>Overview</h2>
<p>Versit also familiarly knows as VCard is file format for electronic representation of business cards which is often exchanged in Mail,Bluetooth, Infrared etc.Most supported version of VCard format is VCard 2.1 (www.imc.org/pdi/vcard-21.rtf). QtVersit implementation follows this specification and also it supports VCard 3.0 ( http://www.ietf.org/rfc/rfc2426.txt) style of encoding.</p>
<p><a href="qversitreader.html">QVersitReader</a> class provides interface to read the VCard 2.1 formatted file content synchronously/asynchronously and produces <a href="qversitdocument.html">QVersitDocument</a>. <a href="qversitdocument.html">QVersitDocument</a> is a place holder for meta data of versit content. This document has set of <a href="qversitproperty.html">QVersitProperty</a> which is basically a name-value pair. Also <a href="qversitproperty.html">QVersitProperty</a> class provides interface to add parameters and group names. Instance of one QveristProperty will hold one and only Name and Value ( One to One association ).</p>
<p><a href="qversitwriter.html">QVersitWriter</a> class provides interface to convert <a href="qversitdocument.html">QVersitDocument</a> into readable VCard formatted file. <a href="qversitwriter.html">QVersitWriter</a> extended into different standard of VCard formats like QVCard21Writer and QVCard30Writer but this class is not exported since needed functionalities for API user will be in baseclass ie <a href="qversitwriter.html">QVersitWriter</a>.</p>
<p>As name specifies QVCard21Writer writes the <a href="qversitdocument.html">QVersitDocument</a> into VCard 2.1 formatted and QVCard30Writer writes <a href="qversitdocument.html">QVersitDocument</a> into VCard 3.0 ( http://www.ietf.org/rfc/rfc2426.txt) formatted.</p>
<p>VCard writers are strict in the sense that it will follow the specifications mentioned above strictly but VCard readers are flexible in certain extend. Also Versit Parser provides utility style classes to generate contact from VCard ( <a href="qversitcontactimporter.html">QVersitContactImporter</a> ) and generate VCard from contact ( <a href="qversitcontactexporter.html">QVersitContactExporter</a> ), both will use <a href="qversitdocument.html">QVersitDocument</a> as input/output data which later can be converted into file by using QVCardWriter. Image and Audio content embedded in VCard will be stored in filesystem , path to filesystem can be set by using QVersitContactImporter::setAudioClipPath and QVersitContactImporter::setImagePath.( See example section for more details ). Filename is generated by using first and last name of contact or as described in VCard Name type field.</p>
<a name="using-the-api"></a>
<h2>Using the API</h2>
<p>This section provides some examples of common usage of the API.</p>
<a name="generating-qcontact-from-vcard-file"></a>
<h3>Generating QContact from VCard file</h3>
<p>Purpose of this example snippet code is to generate QContact from VCard 2.1 formatted file which is passed as an <a href="http://qt.nokia.com/doc/4.5/qiodevice.html">QIODevice</a> argument to snippet function name generateContact(<a href="http://qt.nokia.com/doc/4.5/qiodevice.html">QIODevice</a>&amp;) This function will return one or more QContact based on the input VCard file.It exposes the usage of <a href="qversitreader.html">QVersitReader</a>,<a href="qversitcontactimporter.html">QVersitContactImporter</a> and <a href="qversitdocument.html">QVersitDocument</a>.</p>
<pre>    QList&lt;QContact&gt; VersitDocSample::generateContact(QIODevice&amp; in)
    {
       <span class="comment">// Seek beginning of the file</span>
       in.seek(0);
       <span class="comment">// Create versit reader and read the vcard file content</span>
       QVersitReader* reader = new QVersitReader;
       reader-&gt;setDevice(&amp;in);
       reader-&gt;readAll();
       <span class="comment">// Get list of QVersitDocument from reader</span>
       QList&lt;QVersitDocument&gt; documents = reader-&gt;result();
       <span class="comment">// Create QVersitContactImporter to convert QVersitDocument into QContact</span>
       QVersitContactImporter importer;
       <span class="comment">// Generate contact from each document</span>
       QList&lt;QContact&gt; contacts;
       foreach (QVersitDocument document, documents) {
                <span class="comment">// VCard may have image and audio ( Like LOGO,RINGTONE etc)</span>
                <span class="comment">// Configure the storage location of this content</span>
            importer.setImagePath(QString::fromAscii(&quot;/images/&quot;));
            importer.setAudioClipPath(QString::fromAscii(&quot;/audio/&quot;));
            <span class="comment">// Converts QVersitDocument into QContact</span>
            QContact contact = importer.importContact(document);
            <span class="comment">// Append contact to contact List</span>
            contacts.append(contact);
        }
        delete reader;
        return contacts;
    }</pre>
<a name="generating-vcard-file-from-qcontact"></a>
<h3>Generating VCard file from QContact</h3>
<p>Purpose of this example snippet code is to encode QContact into VCard 2.1 format and write into file. Function named generateVCard(QContact&amp;) takes QContact as a reference argument and converts QContactDetails into <a href="qversitdocument.html">QVersitDocument</a>. Later <a href="qversitdocument.html">QVersitDocument</a> is passed to <a href="qversitwriter.html">QVersitWriter</a> which writes this information into <a href="http://qt.nokia.com/doc/4.5/qiodevice.html">QIODevice</a> which is here nothing but a file. This example snippet shows the usage of <a href="qversitwriter.html">QVersitWriter</a>,<a href="qversitcontactexporter.html">QVersitContactExporter</a> and <a href="qversitdocument.html">QVersitDocument</a>.</p>
<pre>    void VersitDocSample::generateVCard(QContact&amp; contact)
    {
        <span class="comment">// Create versit writer</span>
        QVersitWriter* writer = new QVersitWriter;
        <span class="comment">// Create file and set to writer</span>
        QFile out(&quot;testvcard_2.1-vcf&quot;);
        out.open(QIODevice::ReadWrite);
        writer-&gt;setDevice(&amp;out);
        <span class="comment">// Create QVersitContactExporter to convert QContact into QVersitDocument</span>
        //! [Scaling Example Snippet]
        QVersitContactExporter exporter;
        connect(&amp;exporter, SIGNAL(scale(const QString&amp;,QByteArray&amp;)),
                0, SLOT(scale(const QString&amp;,QByteArray&amp;)));
        //! [Scaling Example Snippet]
        <span class="comment">// Create versit document</span>
        QVersitDocument document = exporter.exportContact(contact,QVersitDocument::VCard21);
        <span class="comment">// Encode and write to output file</span>
        writer-&gt;setVersitDocument(document);
        writer-&gt;writeAll();
    }</pre>
<a name="generating-vcard-file-from-qcontact-and-save-to-contact-database"></a>
<h3>Generating VCard file from QContact and save to contact database</h3>
<p>Purpose of this example snippet code is to generate QContact from VCard 2.1 formatted file which is passed as an <a href="http://qt.nokia.com/doc/4.5/qiodevice.html">QIODevice</a> argument to snippet function name generateContact(<a href="http://qt.nokia.com/doc/4.5/qiodevice.html">QIODevice</a>&amp;) This function will generate one or more QContact based on the input VCard file and writes this contact details to contact database by using QContactManager.It exposes the usage of <a href="qversitreader.html">QVersitReader</a>,<a href="qversitcontactimporter.html">QVersitContactImporter</a>,<a href="qversitdocument.html">QVersitDocument</a> and QContactManager.</p>
<pre>    void VersitDocSample::generateAndSaveContact(QFile&amp; in)
    {
       <span class="comment">// Seek beginning of the file</span>
       in.seek(0);
       <span class="comment">// Create versit reader and read the vcard file content</span>
       QVersitReader* reader = new QVersitReader;
       reader-&gt;setDevice(&amp;in);
       reader-&gt;readAll();
       <span class="comment">// Get list of QVersitDocument from reader</span>
       QList&lt;QVersitDocument&gt; documents = reader-&gt;result();
       <span class="comment">// Create QVersitContactImporter to convert QVersitDocument into QContact</span>
       QVersitContactImporter importer;
       <span class="comment">// Generate contact from each document</span>
       foreach (QVersitDocument document, documents) {
            <span class="comment">// VCard may have image and audio ( Like LOGO,RINGTONE etc)</span>
            <span class="comment">// Configure the storage location of this content</span>
            importer.setImagePath(QString::fromAscii(&quot;/images/&quot;));
            importer.setAudioClipPath(QString::fromAscii(&quot;/audio/&quot;));
            <span class="comment">// Converts QVersitDocument into QContact</span>
            QContact contact = importer.importContact(document);
            <span class="comment">// Save contact</span>
            QContactManager* contactManager = new QContactManager(QString::fromAscii(&quot;symbian&quot;));
            contactManager-&gt;saveContact(&amp;contact);
            delete contactManager;
        }
    }</pre>
<a name="building-and-compiling"></a>
<h2>Building and compiling</h2>
<p>This library requires Qt 4.5 to be installed.</p>
<p>To build the library, run <tt>qmake</tt> and <tt>make</tt>.</p>
<a name="reference-documentation"></a>
<h2>Reference documentation</h2>
<a name="main-classes"></a>
<h3>Main classes</h3>
<ul>
<li><a href="qversitproperty.html">QVersitProperty</a></li>
<li><a href="qversitdocument.html">QVersitDocument</a></li>
<li><a href="qversitreader.html">QVersitReader</a></li>
<li><a href="qversitwriter.html">QVersitWriter</a></li>
<li><a href="qversitcontactimporter.html">QVersitContactImporter</a></li>
<li><a href="qversitcontactexporter.html">QVersitContactExporter</a></li>
</ul>
<a name="asynchronous-requests"></a>
<h3>Asynchronous Requests</h3>
<p><a href="qversitreader.html">QVersitReader</a> provides asynchronous functionality to read VCard formatted file. Reason is file reading could be slow and multiple vcards can present in one input stream. By calling startReading() API of <a href="qversitreader.html">QVersitReader</a> triggers an asynchronous operation and upon completion readingDone() signal is emitted. Results of the parsing can be read from result() API.</p>
<p>Also scaling the image is time consuming operation and does asynchrous operation. When scaling needed <a href="qversitcontactexporter.html">QVersitContactExporter</a> emits a signal scale along with file name of the image and image content which needs to be scaled. For example by writing a below line of code the client can achieve its own scaling functionalities</p>
<pre>        QVersitContactExporter exporter;
        connect(&amp;exporter, SIGNAL(scale(const QString&amp;,QByteArray&amp;)),
                0, SLOT(scale(const QString&amp;,QByteArray&amp;)));
<span class="comment">    // Callback for image scaling</span>
    void VersitDocSample::scale(const QString&amp; imageFileName, QByteArray&amp; imageData)
    {
        int scaledImageHeight = 100;
        int scaledImageWidth = 100;
        if (scaledImageHeight &gt; 0 &amp;&amp; scaledImageWidth &gt; 0) {
            QImage image(imageFileName);
            image = image.scaled(scaledImageHeight,scaledImageWidth);
            QBuffer imageBuffer(&amp;imageData);
            QByteArray fileExtension = imageFileName.section('.',-1).toUpper().toAscii();
            image.save(&amp;imageBuffer,fileExtension.constData());
        }
    }</pre>
<a name="examples"></a>
<h3>Examples</h3>
<p>TODO : Add example code here</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
<td align="right"><div align="right">Qt Contacts</div></td>
</tr></table></div></address></body>
</html>
