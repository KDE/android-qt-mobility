<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- ./contacts.qdoc -->
<head>
  <title>Qt Contacts Developer Resources</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qtlogo.png" align="left" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a></td>
<td align="right" valign="top" width="230"><img src="images/codeless.png"  border="0" /></td></tr></table><h1 class="title">Qt Contacts Developer Resources<br /><span class="subtitle"></span>
</h1>
<ul><li><a href="#introduction">Introduction</a></li>
<li><a href="#overview">Overview</a></li>
<li><a href="#using-the-api">Using the API</a></li>
<ul><li><a href="#filtering-by-detail-definition-and-value">Filtering by detail definition and value</a></li>
<li><a href="#saving-a-new-contact-to-the-default-store">Saving a new contact to the default store</a></li>
<li><a href="#saving-a-new-contact-to-a-particular-manager">Saving a new contact to a particular manager</a></li>
<li><a href="#saving-a-new-contact-to-a-particular-store">Saving a new contact to a particular store</a></li>
<li><a href="#modifying-an-existing-contact-and-saving-the-modifications">Modifying an existing contact and saving the modifications</a></li>
<li><a href="#retrieving-contact-details-for-display">Retrieving contact details for display</a></li>
</ul>
<li><a href="#building-and-compiling">Building and compiling</a></li>
<li><a href="#reference-documentation">Reference documentation</a></li>
<ul><li><a href="#main-classes">Main classes</a></li>
<li><a href="#detail-leaf-classes">Detail leaf classes</a></li>
<li><a href="#examples">Examples</a></li>
</ul>
</ul>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>Qt Contacts provides a set of APIs that allows clients to request contact data from local or remote backends, access to which are provided by implementations of Qt Contacts manager API. This is achieved by defining generic personal information data abstractions which can sufficiently describe contact data stored on any platform. Due to the cross-platform nature of the API, and the ability for developers to write platform-independent implementations of a <a href="qcontactmanager.html">QContactManager</a> which may unify one or more platform specific contact backends, it is intended that the semantics and quirks of the underlying datastores on any platform may be entirely opaque from the perspective of Qt-based, cross-platform client applications.</p>
<a name="overview"></a>
<h2>Overview</h2>
<p>A contact is the digital representation of a person, which is stored in a platform-specific manner. Information pertaining to a single contact may be located across several different datastores, and each datum (or detail) may or may not pertain to a particular context in which that information is valid. A contact may include semantically identical pieces of information that are relevant in different contexts. For example, a contact may have a phone number that is relevant to their &quot;home&quot; context, and another phone number that is relevant to their &quot;work&quot; context. It can be seen that the context of information defines its validity to the user, depending on the context of usage; and as such, the sum of information in a given context can be considered equivalent to a &quot;contextual identity&quot;. This allows great flexibility when consolidating data from various sources into a single, cohesive contact. Contacts may be placed into arbitrary collections called groups. Each group has a name and a unique identifier, and consists of a list of contacts.</p>
<p>Each datum (or detail) stored in a contact has defined semantics of usage and storage. The Qt Contacts API allows per-datastore contact detail definitions, allowing a manager to provide clients with this information on demand, and allowing third-party developers to register detail definitions for use by clients. A detail definition includes the fields (and value-types of those fields) which make up the detail, per-contact uniqueness constraints on details of the definition, and access constraints (such as read-only, create-only, etc).</p>
<p>A detail is a single, cohesive unit of information that is stored in a contact. As explained previously, it is valid for a particular context or set of contexts, and conforms to a particular definition. A detail may have specific metadata associated with it, such as its sub-type, the source of the information, and arbitrary, user-defined metadata.</p>
<p>A manager provides access to zero or more platform-specific datastores. Each datastore may support different capabilities (for example, the ability to store certain datatypes, the ability to natively filter on different details or details of different definitions, the provision of locking mechanisms, the provision of changelog information, etc) which are reported by the manager on request. The manager therefore provides access to detail definitions, contacts, and groups stored in different datastores, in a platform and datastore independent manner. The engine of a manager may be implemented as a plugin to allow dynamic loading of different engines at run-time.</p>
<a name="using-the-api"></a>
<h2>Using the API</h2>
<p>This section provides some examples of common usage of the API.</p>
<a name="filtering-by-detail-definition-and-value"></a>
<h3>Filtering by detail definition and value</h3>
<p>The client instantiates a default manager and asks for any contacts with a particular phone number. The example assumes that the default manager supports the provided <a href="qcontactphonenumber.html">QContactPhoneNumber</a> detail leaf class (which implements the default definition for phone number details).</p>
<pre>    QString incomingCallNbr = &quot;012345678&quot;;
    QContactManager cm; <span class="comment">// retrieves the default manager</span>
    QList&lt;QUniqueId&gt; matchingContacts = cm.contactsWithDetail(&quot;PhoneNumber&quot;, incomingCallNbr);
    if (matchingContacts.size() == 0)
        qDebug() &lt;&lt; &quot;Incoming call from unknown contact (&quot; &lt;&lt; incomingCallNbr &lt;&lt; &quot;)&quot;;
    else
        qDebug() &lt;&lt; &quot;Incoming call from&quot; &lt;&lt; matchingContacts.at(0).name().displayName() &lt;&lt; &quot;(&quot; &lt;&lt; incomingCallNbr &lt;&lt; &quot;)&quot;;</pre>
<a name="saving-a-new-contact-to-the-default-store"></a>
<h3>Saving a new contact to the default store</h3>
<p>The client creates a new contact, adds a name and a phone number, and saves it to the default store of the default manager.</p>
<pre>    QContact c;
    c.name().setFirst(&quot;John&quot;);
    c.name().setLast(&quot;Citizen&quot;);
    QContactDetail phoneNumber;
    phoneNumber.setValue(&quot;PhoneNumber&quot;, &quot;012345678&quot;);
    c.saveDetail(&amp;phoneNumber);

    QContactManager cm;
    if (!cm.saveContact(&amp;c))
        qDebug() &lt;&lt; &quot;Error occurred when saving contact:&quot; &lt;&lt; cm.error();
    else
        qDebug() &lt;&lt; &quot;Contact&quot; &lt;&lt; c.name().displayName() &lt;&lt; &quot;saved successfully!&quot;;</pre>
<a name="saving-a-new-contact-to-a-particular-manager"></a>
<h3>Saving a new contact to a particular manager</h3>
<p>The client creates a new contact, and saves it to the default store of a particular manager (in this case, a vCard backend). While the available managers may be requested from the plugin framework, here we assume that the client knows that the particular manager is available on this platform.</p>
<p>Also, we assume the existence of a specialised leaf-class that allows simple access to details of the definition identified by the &quot;PhoneNumber&quot; identifier. These specialised leaf classes may be written by anyone, and simply wrap the functionality provided by <a href="qcontactdetail.html">QContactDetail</a> in order to allow simpler access to fields supported by a particular definition.</p>
<p>Note that vCard is a registered trademark of the Internet Mail Consortium.</p>
<pre>    QContact c;
    c.name().setFirst(&quot;John&quot;);
    c.name().setLast(&quot;Citizen&quot;);
    QContactPhoneNumber phoneNumber;
    phoneNumber.setNumber(&quot;012345678&quot;);
    c.saveDetail(&amp;phoneNumber);

    QContactManager cm(&quot;com.nokia.mobility.contacts.vCardBackend&quot;);
    if (!cm.saveContact(&amp;c))
        qDebug() &lt;&lt; &quot;Error occurred when saving contact:&quot; &lt;&lt; cm.error();
    else
        qDebug() &lt;&lt; &quot;Contact&quot; &lt;&lt; c.name().displayName() &lt;&lt; &quot;saved successfully!&quot;;</pre>
<a name="saving-a-new-contact-to-a-particular-store"></a>
<h3>Saving a new contact to a particular store</h3>
<p>The client creates a new contact, and saves it to a particular store (in this case, a vCard store) of the default manager. Note that while the available stores may be requested from the capabilities of the manager, we assume in this case that the client knows that the store is available.</p>
<pre>    QContact c;
    c.name().setFirst(&quot;John&quot;);
    c.name().setLast(&quot;Citizen&quot;);
    QContactPhoneNumber phoneNumber;
    phoneNumber.setNumber(&quot;012345678&quot;);
    c.saveDetail(&amp;phoneNumber);

    QContactManager cm(QString(), &quot;vCard&quot;);
    if (!cm.saveContact(&amp;c))
        qDebug() &lt;&lt; &quot;Error occurred when saving contact:&quot; &lt;&lt; cm.error();
    else
        qDebug() &lt;&lt; &quot;Contact&quot; &lt;&lt; c.name().displayName() &lt;&lt; &quot;saved successfully!&quot;</pre>
<a name="modifying-an-existing-contact-and-saving-the-modifications"></a>
<h3>Modifying an existing contact and saving the modifications</h3>
<p>Here we assume that the user has selected a contact in a list widget, and clicked the &quot;Edit&quot; button, or something similar. The client code would retrieve the particular contact from the list (most likely using a class derived from QAbstractListModel), and allow the user to modify that contact.</p>
<pre><span class="comment">    // the client code stores the id of the contact in a user-role (called ContactIdRole) of the model.</span>
<span class="comment">    // we assume that the user wishes to modify the 5th (ie, index 4) contact in the model.</span>
    QUniqueId selectedContactId = model.data(model.index(4), ContactIdRole);

<span class="comment">    // retrieve the contact identified by the particular id from the manager.</span>
    QContactManager cm;
    QContact selected = cm.contact(selectedContactId);

<span class="comment">    // the user has changed the last name of the contact</span>
    selected.name().setLast(&quot;Civilian&quot;);

<span class="comment">    // the user also wants to change the first phone number of the contact</span>
    QContactPhoneNumber phoneNumber = selected.detail(&quot;PhoneNumber&quot;); <span class="comment">// retrieves the first phone number</span>
    phoneNumber.setNumber(&quot;087654321&quot;);

<span class="comment">    // now we save the updated detail.  The old detail will be overwritten in memory.</span>
    selected.saveDetail(&amp;phoneNumber);

<span class="comment">    // and save the updated contact back to the database</span>
    cm.saveContact(&amp;selected);</pre>
<a name="retrieving-contact-details-for-display"></a>
<h3>Retrieving contact details for display</h3>
<p>The user wishes to view the details of a particular contact without modifying them.</p>
<pre><span class="comment">    // retrieve the contact identified by the particular id from the manager.</span>
    QContactManager cm;
    QContact selected = cm.contact(selectedContactId);

<span class="comment">    // retrieve all of the details of the contact.</span>
    QList&lt;QContactDetail&gt; allDetails = selected.details();

<span class="comment">    // for each detail, we want to know which information to display.</span>
<span class="comment">    // so, we ask the manager for the definition of each detail.</span>
    foreach (const QContactDetail&amp; detail, allDetails) {
        <span class="comment">// depending on the field type, we can display each of the fields differently.</span>
        QContactDetailDefinition definition = cm.detailDefinition(detail.definitionId());
        QMap&lt;QString, QVariant::Type&gt; fields = definition.fields();

        <span class="comment">// ...</span>
    }</pre>
<a name="building-and-compiling"></a>
<h2>Building and compiling</h2>
<p>This library requires Qt 4.5 to be installed.</p>
<p>To build the library, run <tt>qmake</tt> and <tt>make</tt>.</p>
<a name="reference-documentation"></a>
<h2>Reference documentation</h2>
<a name="main-classes"></a>
<h3>Main classes</h3>
<ul>
<li><a href="qcontactmanager.html">QContactManager</a></li>
<li><a href="qcontactdetaildefinition.html">QContactDetailDefinition</a></li>
<li><a href="qcontactdetail.html">QContactDetail</a></li>
<li><a href="qcontact.html">QContact</a></li>
<li><a href="qcontactgroup.html">QContactGroup</a></li>
</ul>
<a name="detail-leaf-classes"></a>
<h3>Detail leaf classes</h3>
<p>Several subclasses of <a href="qcontactdetail.html">QContactDetail</a> are provided as part of the Qt Mobility Contacts API. They are general in design but are intended to fulfil specific use-cases. Please note that certain backends may choose not to support one or more of these subclasses as they appear here; they may offer their own which provide similar functionality, or they may require that clients access contact information through the <a href="qcontactdetail.html">QContactDetail</a> base class alone.</p>
<ul>
<li><a href="qcontactaddress.html">QContactAddress</a></li>
<li><a href="qcontactanniversary.html">QContactAnniversary</a></li>
<li><a href="qcontactavatar.html">QContactAvatar</a></li>
<li><a href="qcontactbirthday.html">QContactBirthday</a></li>
<li><a href="qcontactemailaddress.html">QContactEmailAddress</a></li>
<li><a href="qcontactgender.html">QContactGender</a></li>
<li><a href="qcontactguid.html">QContactGuid</a></li>
<li><a href="qcontactname.html">QContactName</a></li>
<li><a href="qcontactphonenumber.html">QContactPhoneNumber</a></li>
<li><a href="qcontactsynctarget.html">QContactSyncTarget</a></li>
<li><a href="qcontacturl.html">QContactUrl</a></li>
</ul>
<p>Each of these subclasses provide access to information stored in fields which are listed in the <a href="contactsschema.html">schema</a>.</p>
<a name="examples"></a>
<h3>Examples</h3>
<ul>
<li><a href="samplephonebook.html">Sample Phonebook</a></li>
</ul>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
<td align="right"><div align="right">Qt Contacts</div></td>
</tr></table></div></address></body>
</html>
