<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en_US" lang="en_US">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<!-- organizerusage.qdoc -->
  <title>Qt 1.1: Organizer API Usage</title>
  <link rel="stylesheet" type="text/css" href="style/style.css" />
  <script src="scripts/jquery.js" type="text/javascript"></script>
  <script src="scripts/functions.js" type="text/javascript"></script>
  <script src="./scripts/superfish.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="style/superfish.css" />  <script src="./scripts/narrow.js" type="text/javascript"></script>
  <link rel="stylesheet" type="text/css" href="style/narrow.css" />
  <!--[if IE]>
<meta name="MSSmartTagsPreventParsing" content="true">
<meta http-equiv="imagetoolbar" content="no">
<![endif]-->
<!--[if lt IE 7]>
<link rel="stylesheet" type="text/css" href="style/style_ie6.css">
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" type="text/css" href="style/style_ie7.css">
<![endif]-->
<!--[if IE 8]>
<link rel="stylesheet" type="text/css" href="style/style_ie8.css">
<![endif]-->
</head>
<body class="" onload="CheckEmptyAndLoadList();">
 <div class="header" id="qtdocheader">
    <div id="nav-logo">
      <a href="index.html">Home</a></div>
    <a href="index.html" class="qtref"><span>Qt Mobility Reference Documentation</span></a>
    <div id="nav-topright">
      <ul>
        <li class="nav-topright-home"><a href="http://qt.nokia.com/">Qt HOME</a></li>
        <li class="nav-topright-dev"><a href="http://qt.nokia.com/developer">DEV</a></li>
        <li class="nav-topright-labs"><a href="http://labs.qt.nokia.com/blogs/">LABS</a></li>
        <li class="nav-topright-doc nav-topright-doc-active"><a href="http://doc.qt.nokia.com/">
          DOC</a></li>
        <li class="nav-topright-blog"><a href="http://blog.qt.nokia.com/">BLOG</a></li>
        <li class="nav-topright-shop"><a title="SHOP" href="http://shop.qt.nokia.com">SHOP</a></li>
      </ul>
    </div>
    <div id="shortCut">
      <ul>
        <li class="shortCut-topleft-inactive"><span><a href="index.html">Mobility 1.1</a></span></li>
        <li class="shortCut-topleft-active"><a href="http://qt.nokia.com/doc/">ALL Qt VERSIONS        </a></li>
      </ul>
    </div>
  </div>
  <div class="wrapper">
    <div class="hd">
      <span></span>
    </div>
    <div class="bd group">
      <div class="sidebar">
        <div class="searchlabel">
          Search index:</div>
        <div class="search">
          <form id="qtdocsearch" action="">
            <fieldset>
              <input type="text" name="searchstring" id="pageType" value="" />
            </fieldset>
          </form>
        </div>
        <div class="box first bottombar" id="lookup">
          <h2><span></span>
            API Lookup</h2>
          <div  id="list001" class="list">
          <ul id="ul001" >
              <li class="defaultLink"><a href="classes.html">Class index</a></li>
              <li class="defaultLink"><a href="functions.html">Function index</a></li>
              <li class="defaultLink"><a href="modules.html">Modules</a></li>
              <li class="defaultLink"><a href="index.html#platform-compatibility">Platform Compatibility</a></li>
            </ul> 
          </div>
        </div>
        <div class="box bottombar" id="topics">
          <h2><span></span>
            Qt Topics</h2>
          <div id="list002" class="list">
            <ul id="ul002" >
              <li class="defaultLink"><a href="http://doc.qt.nokia.com/4.7-snapshot/">Qt 4.7</a></li>
              <li class="defaultLink"><a href="http://doc.qt.nokia.com/4.7-snapshot/qt-basic-concepts.html">Basic Qt architecture</a></li>
              <li class="defaultLink"><a href="http://doc.qt.nokia.com/4.7-snapshot/declarativeui.html">Device UI's &amp; Qt Quick</a></li>
              <li class="defaultLink"><a href="http://doc.qt.nokia.com/4.7-snapshot/qt-gui-concepts.html">Desktop UI components</a></li>
              <li class="defaultLink"><a href="http://doc.qt.nokia.com/4.7-snapshot/platform-specific.html">Platform-specific info</a></li>
            </ul>  
          </div>
        </div>
        <div class="box" id="examples">
          <h2><span></span>
            Examples</h2>
          <div id="list003" class="list">
        <ul id="ul003">
              <li class="defaultLink"><a href="all-examples.html">Examples</a></li>
            </ul> 
          </div>
        </div>
      </div>
      <div class="wrap">
        <div class="toolbar">
          <div class="breadcrumb toolblock">
            <ul>
              <li class="first"><a href="index.html">Home</a></li>
              <!--  Bread crumbs goes here -->
              <li>Organizer API Usage</li>            </ul>
          </div>
          <div class="toolbuttons toolblock">
            <ul>
              <li id="smallA" class="t_button">A</li>
              <li id="medA" class="t_button active">A</li>
              <li id="bigA" class="t_button">A</li>
              <li id="print" class="t_button"><a href="javascript:this.print();">
                <span>Print</span></a></li>
            </ul>
          </div>
        </div>
        <div class="content">
<div class="toc">
<h3><a name="toc">Contents</a></h3>
<ul>
<li class="level1"><a href="#introduction">Introduction</a></li>
<li class="level1"><a href="#manager-settings-and-configuration">Manager Settings And Configuration</a></li>
<li class="level2"><a href="#querying-a-manager-for-capabilities">Querying a manager for capabilities</a></li>
<li class="level2"><a href="#loading-the-manager-for-a-specific-backend">Loading the manager for a specific backend</a></li>
<li class="level2"><a href="#loading-a-manager-with-specific-parameters">Loading a manager with specific parameters</a></li>
<li class="level1"><a href="#organizer-item-detail-manipulation">Organizer Item Detail Manipulation</a></li>
<li class="level1"><a href="#persistent-organizer-item-information">Persistent Organizer Item Information</a></li>
<li class="level2"><a href="#creating-a-new-item-in-a-manager">Creating a new item in a manager</a></li>
<li class="level2"><a href="#retrieving-items-from-a-manager">Retrieving items from a manager</a></li>
<li class="level2"><a href="#updating-an-existing-item-in-a-manager">Updating an existing item in a manager</a></li>
<li class="level2"><a href="#removing-an-item-from-a-manager">Removing an item from a manager</a></li>
<li class="level2"><a href="#optimization-in-item-retrieval">Optimization in item retrieval</a></li>
<li class="level2"><a href="#querying-the-schema-supported-by-a-manager">Querying the schema supported by a manager</a></li>
<li class="level2"><a href="#modifying-the-schema-supported-by-a-manager">Modifying the schema supported by a manager</a></li>
<li class="level1"><a href="#recurring-items">Recurring items</a></li>
<li class="level1"><a href="#multiple-organizers">Multiple organizers</a></li>
</ul>
</div>
<h1 class="title">Organizer API Usage</h1>
<span class="subtitle"></span>
<!-- $$$organizerusage.html-description -->
<div class="descr"> <a name="details"></a>
<a name="introduction"></a>
<h2>Introduction</h2>
<p>This section provides some examples of common usage of the Qt Organizer API.</p>
<a name="manager-settings-and-configuration"></a>
<h2>Manager Settings And Configuration</h2>
<p>Users of the items API can define which backend they wish to access if a manager for that backend is available. The list of available managers can be queried programmatically at run-time, and the capabilities of different managers can be ascertained by inspecting a <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> instance. Furthermore, some managers can be constructed with parameters which affect the operation of the backend. In this example, the client constructs a particular backend, but does not construct it with any special parameters:</p>
<pre class="highlightedCode brush: cpp">     QOrganizerItemManager specificManager(&quot;KCal&quot;);</pre>
<p>Most users of the API will want to use the default manager for the platform, which provides access to the system address book. Instantiating a manager by using the default constructor will result in the default manager for that platform being instantiated:</p>
<pre class="highlightedCode brush: cpp">     QOrganizerItemManager defaultManager;</pre>
<p>The default constructor can either be used to create a manager on the stack, in which case it will be deleted automatically when it goes out of scope, or it can be used explicitly to create a manager on the heap, in which case the client must ensure that they delete the manager when they are finished with it in order to avoid a memory leak.</p>
<a name="querying-a-manager-for-capabilities"></a>
<h3>Querying a manager for capabilities</h3>
<p>Different managers will support different capabilities and details. Clients can use the meta data reporting functions of <a href="qorganizeritemmanager.html">QOrganizerItemManager</a> to determine what the capabilities of the manager they have instantiated might be.</p>
<a name="loading-the-manager-for-a-specific-backend"></a>
<h3>Loading the manager for a specific backend</h3>
<p>The client can choose to load a manager for a specific backend. While the engine could be found and retrieved using a more advanced plugin framework (such as the Qt Service Framework), this code assumes that the client has prior knowledge of the backend in question:</p>
<pre class="highlightedCode brush: cpp">     QOrganizerItemManager specificManager(&quot;KCal&quot;);</pre>
<p>Clients may wish to use this feature of the API if they wish to store or retrieve item information to a particular manager (for example, one that interfaces with a particular online service).</p>
<a name="loading-a-manager-with-specific-parameters"></a>
<h3>Loading a manager with specific parameters</h3>
<p>The client can loads a manager with specific parameters defined. The parameters which are available are backend specific, and so the client has to know which parameters are valid for a particular backend, and what argument it takes.</p>
<a name="organizer-item-detail-manipulation"></a>
<h2>Organizer Item Detail Manipulation</h2>
<p>Once an item has been created (or retrieved from a manager), the client can retrieve, create, update or delete details from the item. Since <a href="qorganizeritem.html">QOrganizerItem</a> and <a href="qorganizeritemdetail.html">QOrganizerItemDetail</a> are both container (value) classes, the API offered for these operations is purely synchronous.</p>
<p>An item consists of the details it contains, as well as an id. Some details are read-only (such as the modification timestamp of an item) or irremovable (like the type of an item), but most are freely modifiable by clients. The <a href="qorganizeritem.html#details">QOrganizerItem::details</a>(), <a href="qorganizeritem.html#detail">QOrganizerItem::detail</a>(), <a href="qorganizeritem.html#saveDetail">QOrganizerItem::saveDetail</a>() and <a href="qorganizeritem.html#removeDetail">QOrganizerItem::removeDetail</a>() functions can be used to manipulate these details.</p>
<p>To aid in the manipulation of common details, convenience functions are provided in <a href="qorganizeritem.html">QOrganizerItem</a> like setDisplayLabel() and setDescription() which set and access the details directly. Many details are specific to particular types of items, and convenience functions for these are provided in the subclasses of <a href="qorganizeritem.html">QOrganizerItem</a>. For example, the <a href="qorganizerevent.html">QOrganizerEvent</a> class provides the function setStartDateTime(), which is equivalent to getting the <a href="qorganizereventtimerange.html">QOrganizerEventTimeRange</a> detail, setting the StartDateTime field and resaving it.</p>
<p>It is important to note that details are implicitly shared objects with particular semantics surrounding saving, removal and modification.</p>
<a name="persistent-organizer-item-information"></a>
<h2>Persistent Organizer Item Information</h2>
<p>After instantiating a manager, clients will wish to retrieve or modify item information (detail definitions) which is persistently stored in the manager (for example, in a database or online cloud). This may be done synchronously or asynchronously. And example of synchronous usage is as follows:</p>
<p>If the client wishes to use the asynchronous API, it is suggested that their class uses member variables for the manager and requests. This allows them to define slots which deal with the data as required when the state of the request changes.</p>
<p>Note that if the client is interested in receiving the results of the request as they become available, rather than only the final set of results once the request changes state (to <tt>FinishedState</tt>, for example), the client should instead connect the <a href="qorganizeritemabstractrequest.html#resultsAvailable">QOrganizerItemAbstractRequest::resultsAvailable</a>() signal to the slot which deals with the results.</p>
<a name="creating-a-new-item-in-a-manager"></a>
<h3>Creating a new item in a manager</h3>
<p>Clients can create a new item simply by instantiating one and saving it a manager. The save operation will succeed if the item initially had a zero-id, and if the manager supports the details in the item. The item may be saved either synchronously by directly calling <a href="qorganizeritemmanager.html#saveItem">QOrganizerItemManager::saveItem</a>() or asynchronously using a <a href="qorganizeritemsaverequest.html">QOrganizerItemSaveRequest</a> and connecting to that request's change signals. Alternatively, the client can explicitly block execution until the request is complete, by calling waitForFinished().</p>
<pre class="highlightedCode brush: cpp">     <span class="comment">// a default constructed journal will have it's date/time set to the current date/time.</span>
     QOrganizerJournal journal;
     journal.setDescription(&quot;The conference went well.  We all agree that marshmallows are awesome, &quot;\
                     &quot;but we were unable to reach any agreement as to how we could possibly &quot;\
                     &quot;increase our intake of marshmallows.  Several action points were assigned &quot;\
                     &quot;to various members of the group; I have been tasked with finding a good &quot;\
                     &quot;recipe that combines both marshmallows and chocolate, by next Wednesday.&quot;);
     defaultManager.saveItem(&amp;journal);</pre>
<a name="retrieving-items-from-a-manager"></a>
<h3>Retrieving items from a manager</h3>
<p>The client requests all items from the manager which match a particular filter, sorted according to a particular sort order.</p>
<pre class="highlightedCode brush: cpp">     <span class="comment">// XXX TODO: make this more convenient.</span>
     <span class="comment">// QOrganizerItemLocation::matchLocationName(&quot;Meeting Room 8&quot;) ?</span>
     QOrganizerItemDetailFilter locationFilter;
     locationFilter.setDetailDefinitionName(QOrganizerItemLocation::DefinitionName, QOrganizerItemLocation::FieldLocationName);
     locationFilter.setValue(&quot;Meeting Room 8&quot;);
     QList&lt;QOrganizerItem&gt; entries = defaultManager.items(locationFilter);</pre>
<p>The client can also retrieve a particular existing item from a manager, by directly requesting the item with a particular (previously known) id. With the asynchronous API, this takes the form of another filter. The synchronous API provides the <a href="qorganizeritemmanager.html#item">QOrganizerItemManager::item</a>() function specifically for this purpose.</p>
<p>Some items which clients are interested in may not be explicitly stored in the manager, but rather dynamically generated given a recurrence rule which is saved in a particular item. These are known as occurrences and may be retrieved by calling itemInstances(). Once retrieved, a generated occurrence may be saved into the manager, at which point it becomes an exception to the original item.</p>
<pre class="highlightedCode brush: cpp">     <span class="comment">// the following line should be made simpler via QOIM::itemInstances(item, startDateTime, endDateTime, count)...</span>
     QOrganizerEventOccurrence nextMarshmallowMeeting = QOrganizerEventOccurrence(defaultManager.itemInstances().value(0)); <span class="comment">// should use dfil.</span>
     nextMarshmallowMeeting.setStartDateTime(QDateTime::fromString(&quot;13.05.2010 18:00:00&quot;, &quot;dd.MM.yy hh:mm:ss&quot;));
     nextMarshmallowMeeting.setEndDateTime(QDateTime::fromString(&quot;13.05.2010 20:00:00&quot;, &quot;dd.MM.yy hh:mm:ss&quot;));
     nextMarshmallowMeeting.addComment(&quot;The next meeting will go for an hour longer (starting one &quot;\
                                       &quot;hour earlier than usual), since we have scheduled one hour&quot;\
                                       &quot;to taste the results of the recipe that I will be presenting &quot;\
                                       &quot;at the meeting.&quot;);
     defaultManager.saveItem(&amp;nextMarshmallowMeeting);</pre>
<a name="updating-an-existing-item-in-a-manager"></a>
<h3>Updating an existing item in a manager</h3>
<p>The client updates a previously saved item by saving the updated version of the item. Any item whose id is the same as that of the updated item will be overwritten as a result of the save request.</p>
<pre class="highlightedCode brush: cpp">     journal.addComment(&quot;Serves: 8.  Ingredients: 500g Milk Chocolate, 500g Marshmallows.  Step 1: Put the marshmallows into 8 separate bowls.  Step 2: Melt the chocolate.  Step 3: Pour the chocolate over the marshmallows in the bowls.  Step 4: Put the bowls into the refrigerator for 20 minutes; serve chilled.&quot;);
     if (!defaultManager.saveItem(&amp;journal)) qDebug() &lt;&lt; &quot;Unable to save updated journal!  Error:&quot; &lt;&lt; defaultManager.error();</pre>
<a name="removing-an-item-from-a-manager"></a>
<h3>Removing an item from a manager</h3>
<p>The client may remove an item from the manager by specifying its local id.</p>
<a name="optimization-in-item-retrieval"></a>
<h3>Optimization in item retrieval</h3>
<p>Clients can inform the manager that they do not require certain details from an item, which can allow a manager to optimize item retrieval. In this way, the client can inform the manager that they are not interested in any binary blob data (e.g&#x2e;, images) in retrieved items.</p>
<a name="querying-the-schema-supported-by-a-manager"></a>
<h3>Querying the schema supported by a manager</h3>
<p>A client may query the schema supported by a manager, and check to see if a particular detail definition supports a certain field.</p>
<a name="modifying-the-schema-supported-by-a-manager"></a>
<h3>Modifying the schema supported by a manager</h3>
<p>A client may attempt to modify a particular detail definition by extending it so that it supports an extra field, or add a new detail definition, or remove an existing one. These operations are not necessarily supported on various backends, and even those backends which do support a mutable schema may not allow modification of the default detail definitions.</p>
<p>Note that some managers do not support mutable definitions, and hence attempting to modify or remove detail definitions in those managers will fail.</p>
<a name="recurring-items"></a>
<h2>Recurring items</h2>
<p>A recurring item is an item that occurs more than once; for example, a meeting that occurs every week for the next 10 weeks. A recurring item is created by creating a <a href="qorganizerevent.html">QOrganizerEvent</a> or <a href="qorganizertodo.html">QOrganizerTodo</a> and adding a <a href="qorganizeritemrecurrence.html">QOrganizerItemRecurrence</a> detail to it to specify the rules for when it should recur. While the item occurs multiple times, the client only has to create it once and save it once. When <a href="qorganizeritemmanager.html#itemInstances">QOrganizerItemManager::itemInstances</a>() is called, any recurring items are expanded into multiple <a href="qorganizereventoccurrence.html">QOrganizerEventOccurrence</a> and <a href="qorganizertodooccurrence.html">QOrganizerTodoOccurrence</a> items by the manager. Each generated occurrence item has a local id of zero.</p>
<p>The client is able to make an exception for an occurrence by taking a generated item occurrence from the manager, making the necessary modifications, and resaving it. When the manager is then queried with <a href="qorganizeritemmanager.html#itemInstances">QOrganizerItemManager::itemInstances</a>(), it will return the list of occurrences as before, but with the modifications in place. The modified item will be given a non-zero local id, and replaces the generated one in the list.</p>
<p>The client can also query the manager for a list of unexpanded items by calling <a href="qorganizeritemmanager.html#items">QOrganizerItemManager::items</a>(). The list of returned items will contain all items that have been saved to the manager with a call to saveItem() (of course, without any items removed with removeItem()). That is, recurring events will be returned as is, and event occurrences will not appear unless they are exceptions (ie. have a non-zero local id). Fetching the list in this way can be useful for transfering items to other managers or for exporting to iCalendar with <a href="qtversit.html">QtVersit</a>.</p>
<a name="multiple-organizers"></a>
<h2>Multiple organizers</h2>
<p>It may be useful for clients to separate their organizer items into different organizers (eg. Personal and Work) and work with different views that show items from one, some or all of these organizers. This is functionality has not been implemented in this technical preview, but we currently are investigating the best model to use to offer this.</p>
</div>
<!-- @@@organizerusage.html -->
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009-2010 Nokia Corporation and/or its subsidiary(-ies)</td>
<td width="20%" align="center"><a href="trademarks.html">Trademarks</a></td>
<td align="right"><div align="right">Qt Mobility Project 1.1.0</div></td>
</tr></table></div></address>  <script src="scripts/functions.js" type="text/javascript"></script>
  <!-- <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-4457116-5']);
  _gaq.push(['_trackPageview']);
  (function() {
  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
  </script> -->
</body>
</html>
