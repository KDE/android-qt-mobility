<?xml version="1.0" encoding="iso-8859-1"?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<!-- ../../serviceframework/qservicemanager.cpp -->
<head>
  <title>QServiceManager Class Reference</title>
  <link href="classic.css" rel="stylesheet" type="text/css" />
</head>
<body>
<table border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td align="left" valign="top" width="32"><img src="images/qtlogo.png" align="left" border="0" /></td>
<td width="1">&nbsp;&nbsp;</td><td class="postheader" valign="center"><a href="index.html"><font color="#004faf">Home</font></a></td>
<td align="right" valign="top" width="230"><img src="images/codeless.png"  border="0" /></td></tr></table><h1 class="title">QServiceManager Class Reference</h1>
<p>The QServiceManager class enables the loading of service plugins and the (de)registration of services. <a href="#details">More...</a></p>
<pre>    #include &lt;QServiceManager&gt;</pre><ul>
<li><a href="qservicemanager-members.html">List of all members, including inherited members</a></li>
</ul>
<a name="public-types"></a>
<h3>Public Types</h3>
<ul>
<li><div class="fn"/>enum <b><a href="qservicemanager.html#Error-enum">Error</a></b> { NoError, StorageAccessError, InvalidServiceLocation, InvalidServiceXml, ..., UnknownError }</li>
<li><div class="fn"/>enum <b><a href="qservicemanager.html#Scope-enum">Scope</a></b> { UserScope, SystemScope }</li>
</ul>
<a name="public-functions"></a>
<h3>Public Functions</h3>
<ul>
<li><div class="fn"/><b><a href="qservicemanager.html#QServiceManager">QServiceManager</a></b> ( QObject * <i>parent</i> = 0 )</li>
<li><div class="fn"/><b><a href="qservicemanager.html#QServiceManager-2">QServiceManager</a></b> ( Scope <i>scope</i>, QObject * <i>parent</i> = 0 )</li>
<li><div class="fn"/><b><a href="qservicemanager.html#dtor.QServiceManager">~QServiceManager</a></b> ()</li>
<li><div class="fn"/>bool <b><a href="qservicemanager.html#addService">addService</a></b> ( const QString &amp; <i>xmlFilePath</i> )</li>
<li><div class="fn"/>bool <b><a href="qservicemanager.html#addService-2">addService</a></b> ( QIODevice * <i>device</i> )</li>
<li><div class="fn"/>Error <b><a href="qservicemanager.html#error">error</a></b> () const</li>
<li><div class="fn"/>QList&lt;QServiceInterfaceDescriptor&gt; <b><a href="qservicemanager.html#findInterfaces">findInterfaces</a></b> ( const QServiceFilter &amp; <i>filter</i> = QServiceFilter() ) const</li>
<li><div class="fn"/>QList&lt;QServiceInterfaceDescriptor&gt; <b><a href="qservicemanager.html#findInterfaces-2">findInterfaces</a></b> ( const QString &amp; <i>serviceName</i> ) const</li>
<li><div class="fn"/>QStringList <b><a href="qservicemanager.html#findServices">findServices</a></b> ( const QString &amp; <i>interfaceName</i> = QString() ) const</li>
<li><div class="fn"/>T * <b><a href="qservicemanager.html#getInterface">getInterface</a></b> ( const QString &amp; <i>interfaceName</i>, QServiceContext * <i>context</i> = 0, QAbstractSecuritySession * <i>session</i> = 0 )</li>
<li><div class="fn"/>T * <b><a href="qservicemanager.html#getInterface-2">getInterface</a></b> ( const QServiceInterfaceDescriptor &amp; <i>serviceDescriptor</i>, QServiceContext * <i>context</i>, QAbstractSecuritySession * <i>session</i> )</li>
<li><div class="fn"/>QServiceInterfaceDescriptor <b><a href="qservicemanager.html#interfaceDefault">interfaceDefault</a></b> ( const QString &amp; <i>interfaceName</i> ) const</li>
<li><div class="fn"/>QObject * <b><a href="qservicemanager.html#loadInterface">loadInterface</a></b> ( const QString &amp; <i>interfaceName</i>, QServiceContext * <i>context</i> = 0, QAbstractSecuritySession * <i>session</i> = 0 )</li>
<li><div class="fn"/>QObject * <b><a href="qservicemanager.html#loadInterface-2">loadInterface</a></b> ( const QServiceInterfaceDescriptor &amp; <i>descriptor</i>, QServiceContext * <i>context</i> = 0, QAbstractSecuritySession * <i>session</i> = 0 )</li>
<li><div class="fn"/>bool <b><a href="qservicemanager.html#removeService">removeService</a></b> ( const QString &amp; <i>serviceName</i> )</li>
<li><div class="fn"/>Scope <b><a href="qservicemanager.html#scope">scope</a></b> () const</li>
<li><div class="fn"/>bool <b><a href="qservicemanager.html#setInterfaceDefault">setInterfaceDefault</a></b> ( const QString &amp; <i>service</i>, const QString &amp; <i>interfaceName</i> )</li>
<li><div class="fn"/>bool <b><a href="qservicemanager.html#setInterfaceDefault-2">setInterfaceDefault</a></b> ( const QServiceInterfaceDescriptor &amp; <i>descriptor</i> )</li>
</ul>
<a name="signals"></a>
<h3>Signals</h3>
<ul>
<li><div class="fn"/>void <b><a href="qservicemanager.html#serviceAdded">serviceAdded</a></b> ( const QString &amp; <i>serviceName</i>, QServiceManager::Scope <i>scope</i> )</li>
<li><div class="fn"/>void <b><a href="qservicemanager.html#serviceRemoved">serviceRemoved</a></b> ( const QString &amp; <i>serviceName</i>, QServiceManager::Scope <i>scope</i> )</li>
</ul>
<a name="details"></a>
<hr />
<h2>Detailed Description</h2>
<p>The QServiceManager class enables the loading of service plugins and the (de)registration of services.</p>
<p>A service is a stand-alone component that can be used by multiple clients. Each service implementation must derive from QObject. Clients request a reference to a service via <a href="qservicemanager.html#loadInterface">loadInterface</a>() or <a href="qservicemanager.html#getInterface">getInterface</a>().</p>
<p>Services are separate deliveries in the form of plug-ins. New services can be (de)registered at any time via <a href="qservicemanager.html#addService">addService</a>() and <a href="qservicemanager.html#removeService">removeService</a>() respectively. Such an event is published via the <a href="qservicemanager.html#serviceAdded">serviceAdded</a>() and <a href="qservicemanager.html#serviceRemoved">serviceRemoved</a>() signal. Each service plug-in must implement <a href="qserviceplugininterface.html">QServicePluginInterface</a>.</p>
<p>Each plug-in may support multiple interfaces and may even provide multiple implementations for the same interface. Individual implementations are identified via <a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a>. For a more detailed explanation of services and how they relate to interface and their implementations please see <a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a>.</p>
<p>See also <a href="qserviceplugininterface.html">QServicePluginInterface</a>, <a href="qservicecontext.html">QServiceContext</a>, and <a href="qabstractsecuritysession.html">QAbstractSecuritySession</a>.</p>
<hr />
<h2>Member Type Documentation</h2>
<h3 class="fn"><a name="Error-enum"></a>enum QServiceManager::Error</h3>
<p>Defines the possible errors for the service manager.</p>
<p><table border="1" cellpadding="2" cellspacing="1" width="100%">
<tr><th width="25%">Constant</th><th width="15%">Value</th><th width="60%">Description</th></tr>
<tr><td valign="top"><tt>QServiceManager::NoError</tt></td><td align="center" valign="top"><tt>0</tt></td><td valign="top">No error occurred.</td></tr>
<tr><td valign="top"><tt>QServiceManager::StorageAccessError</tt></td><td align="center" valign="top"><tt>1</tt></td><td valign="top">The service data storage is not accessible. This could be because the caller does not have the required permissions.</td></tr>
<tr><td valign="top"><tt>QServiceManager::InvalidServiceLocation</tt></td><td align="center" valign="top"><tt>2</tt></td><td valign="top">The service was not found at its specified <a href="qserviceinterfacedescriptor.html#PropertyKey-enum">location</a>.</td></tr>
<tr><td valign="top"><tt>QServiceManager::InvalidServiceXml</tt></td><td align="center" valign="top"><tt>3</tt></td><td valign="top">The XML defining the service metadata is invalid.</td></tr>
<tr><td valign="top"><tt>QServiceManager::InvalidServiceInterfaceDescriptor</tt></td><td align="center" valign="top"><tt>4</tt></td><td valign="top">The service interface descriptor is invalid, or refers to an interface implementation that cannot be accessed in the current scope.</td></tr>
<tr><td valign="top"><tt>QServiceManager::ServiceAlreadyExists</tt></td><td align="center" valign="top"><tt>5</tt></td><td valign="top">Another service has previously been registered with the same <a href="qserviceinterfacedescriptor.html#PropertyKey-enum">location</a>.</td></tr>
<tr><td valign="top"><tt>QServiceManager::ImplementationAlreadyExists</tt></td><td align="center" valign="top"><tt>6</tt></td><td valign="top">Another service that implements the same interface version has previously been registered.</td></tr>
<tr><td valign="top"><tt>QServiceManager::PluginLoadingFailed</tt></td><td align="center" valign="top"><tt>7</tt></td><td valign="top">The service plugin cannot be loaded.</td></tr>
<tr><td valign="top"><tt>QServiceManager::ComponentNotFound</tt></td><td align="center" valign="top"><tt>8</tt></td><td valign="top">The service or interface implementation has not been registered.</td></tr>
<tr><td valign="top"><tt>QServiceManager::ServiceCapabilityDenied</tt></td><td align="center" valign="top"><tt>9</tt></td><td valign="top">The security session does not allow the service based on its capabilities.</td></tr>
<tr><td valign="top"><tt>QServiceManager::UnknownError</tt></td><td align="center" valign="top"><tt>100</tt></td><td valign="top">An unknown error occurred.</td></tr>
</table></p>
<h3 class="fn"><a name="Scope-enum"></a>enum QServiceManager::Scope</h3>
<p><table border="1" cellpadding="2" cellspacing="1" width="100%">
<tr><th width="25%">Constant</th><th width="15%">Value</th><th width="60%">Description</th></tr>
<tr><td valign="top"><tt>QServiceManager::UserScope</tt></td><td align="center" valign="top"><tt>0</tt></td><td valign="top">When adding and removing services, use a storage location specific to the current user (e.g&#x2e; in the user's home directory). When searching for services and interface implementations, first search in the user-specific location; if the service or interface implementation is not found, search in the system-wide storage location (if the user has sufficient permissions to do so).</td></tr>
<tr><td valign="top"><tt>QServiceManager::SystemScope</tt></td><td align="center" valign="top"><tt>1</tt></td><td valign="top">When adding and removing services, use a system-wide storage location accessible to all users. When searching for services and interface implementations, search only in the system-wide storage location.</td></tr>
</table></p>
<hr />
<h2>Member Function Documentation</h2>
<h3 class="fn"><a name="QServiceManager"></a>QServiceManager::QServiceManager ( QObject * <i>parent</i> = 0 )</h3>
<p>Creates a service manager with the given <i>parent</i>.</p>
<p>The scope will default to <a href="qservicemanager.html#Scope-enum">QServiceManager::UserScope</a>.</p>
<h3 class="fn"><a name="QServiceManager-2"></a>QServiceManager::QServiceManager ( <a href="qservicemanager.html#Scope-enum">Scope</a> <i>scope</i>, QObject * <i>parent</i> = 0 )</h3>
<p>Creates a service manager with the given <i>scope</i> and <i>parent</i>.</p>
<h3 class="fn"><a name="dtor.QServiceManager"></a>QServiceManager::~QServiceManager ()</h3>
<p>Destroys the service manager.</p>
<h3 class="fn"><a name="addService"></a>bool QServiceManager::addService ( const QString &amp; <i>xmlFilePath</i> )</h3>
<p>Registers the service defined by the XML file at <i>xmlFilePath</i>. Returns true if the registration succeeded, and false otherwise.</p>
<p>If a previously unkown interface is added the newly registered service automatically becomes the new default service provider for the new interface.</p>
<p>A service plugin cannot be added if another service is already registered with the same plugin file path. A service plugin also cannot be added if the service is already registered and implements any of the same interface versions that the new plugin implements.</p>
<p>See also <a href="qservicemanager.html#setInterfaceDefault">setInterfaceDefault</a>().</p>
<h3 class="fn"><a name="addService-2"></a>bool QServiceManager::addService ( QIODevice * <i>device</i> )</h3>
<p>This is an overloaded member function, provided for convenience.</p>
<p>Registers the service defined by the XML data from the given <i>device</i>. Returns true if the registration succeeded, and false otherwise. If a previously unkown interface is added the newly registered service automatically becomes the new default service provider for the new interface.</p>
<p>Registering a service also causes <a href="qserviceplugininterface.html#installService">QServicePluginInterface::installService</a>() to be called on the service. If the service plugin is not accessible (e.g&#x2e; if the plugin file is not found) and <tt>installService()</tt> cannot be invoked on the service, the registration fails and this method returns false.</p>
<p>A service plugin cannot be added if another service is already registered with the same plugin file path. A service plugin also cannot be added if the service is already registered and implements any of the same interface versions that the new plugin implements.</p>
<p>Services are always added based on the <a href="qservicemanager.html#scope">scope</a>() of the current service manager instance.</p>
<p>See also <a href="qservicemanager.html#setInterfaceDefault">setInterfaceDefault</a>().</p>
<h3 class="fn"><a name="error"></a><a href="qservicemanager.html#Error-enum">Error</a> QServiceManager::error () const</h3>
<p>Returns the type of error that last occurred.</p>
<h3 class="fn"><a name="findInterfaces"></a>QList&lt;<a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a>&gt; QServiceManager::findInterfaces ( const <a href="qservicefilter.html">QServiceFilter</a> &amp; <i>filter</i> = QServiceFilter() ) const</h3>
<p>Returns a list of the interfaces that match the specified <i>filter</i>.</p>
<h3 class="fn"><a name="findInterfaces-2"></a>QList&lt;<a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a>&gt; QServiceManager::findInterfaces ( const QString &amp; <i>serviceName</i> ) const</h3>
<p>This is an overloaded member function, provided for convenience.</p>
<p>Returns a list of the interfaces provided by the service named <i>serviceName</i>.</p>
<h3 class="fn"><a name="findServices"></a>QStringList QServiceManager::findServices ( const QString &amp; <i>interfaceName</i> = QString() ) const</h3>
<p>Returns a list of the services that provide the interface specified by <i>interfaceName</i>.</p>
<h3 class="fn"><a name="getInterface"></a>T * QServiceManager::getInterface ( const QString &amp; <i>interfaceName</i>, <a href="qservicecontext.html">QServiceContext</a> * <i>context</i> = 0, <a href="qabstractsecuritysession.html">QAbstractSecuritySession</a> * <i>session</i> = 0 )</h3>
<p>Loads the service object implementing <i>interfaceName</i>, as provided by the default service for this interface, using the given <i>context</i> and <i>session</i>. <i>context</i> and <i>session</i> object are owned by the caller of this function. The template class must be derived from QObject.</p>
<p>If <i>interfaceName</i> is not a known interface the returned pointer will be null.</p>
<p>The caller takes ownership of the returned pointer.</p>
<h3 class="fn"><a name="getInterface-2"></a>T * QServiceManager::getInterface ( const <a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a> &amp; <i>serviceDescriptor</i>, <a href="qservicecontext.html">QServiceContext</a> * <i>context</i>, <a href="qabstractsecuritysession.html">QAbstractSecuritySession</a> * <i>session</i> )</h3>
<p>This is an overloaded member function, provided for convenience.</p>
<p>Loads the service object identified by <i>serviceDescriptor</i> using the given <i>context</i> and <i>session</i>. <i>context</i> and <i>session</i> object are owned by the caller of this function. The template class must be derived from QObject.</p>
<p>If the <i>serviceDescriptor</i> is not valid the returned pointer will be null.</p>
<p>The caller takes ownership of the returned pointer.</p>
<h3 class="fn"><a name="interfaceDefault"></a><a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a> QServiceManager::interfaceDefault ( const QString &amp; <i>interfaceName</i> ) const</h3>
<p>Returns the default interface implementation for the given <i>interfaceName</i>.</p>
<p>See also <a href="qservicemanager.html#setInterfaceDefault">setInterfaceDefault</a>().</p>
<h3 class="fn"><a name="loadInterface"></a>QObject * QServiceManager::loadInterface ( const QString &amp; <i>interfaceName</i>, <a href="qservicecontext.html">QServiceContext</a> * <i>context</i> = 0, <a href="qabstractsecuritysession.html">QAbstractSecuritySession</a> * <i>session</i> = 0 )</h3>
<p>Loads and returns the interface specified by <i>interfaceName</i>, as provided by the default service for this interface, using the given <i>context</i> and <i>session</i>. <i>context</i> and <i>session</i> object are owned by the caller of this function.</p>
<p>The caller takes ownership of the returned pointer.</p>
<p>This function returns a null pointer if the requested service cannot be found.</p>
<h3 class="fn"><a name="loadInterface-2"></a>QObject * QServiceManager::loadInterface ( const <a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a> &amp; <i>descriptor</i>, <a href="qservicecontext.html">QServiceContext</a> * <i>context</i> = 0, <a href="qabstractsecuritysession.html">QAbstractSecuritySession</a> * <i>session</i> = 0 )</h3>
<p>This is an overloaded member function, provided for convenience.</p>
<p>Loads and returns the interface specified by <i>descriptor</i> using the given <i>context</i> and <i>session</i>. <i>context</i> and <i>session</i> object are owned by the caller of this function.</p>
<p>The caller takes ownership of the returned pointer.</p>
<p>This function returns a null pointer if the requested service cannot be found.</p>
<h3 class="fn"><a name="removeService"></a>bool QServiceManager::removeService ( const QString &amp; <i>serviceName</i> )</h3>
<p>Unregisters the service specified by <i>serviceName</i>.</p>
<p>Returns true if the unregistration succeeded, and false otherwise.</p>
<p>If a default service implementation is removed and there are other implementations for the same interface, the service manager chooses the implementation with the highest version number as the new default. If there is more than one serivce with the same version number, the service manager makes a random choice with regards to the new default implementation. If this is not the desired behaviour the default selection should be updated via <a href="qservicemanager.html#setInterfaceDefault">setInterfaceDefault</a>().</p>
<p>Services are always removed based on the <a href="qservicemanager.html#scope">scope</a>() of the current service manager instance.</p>
<h3 class="fn"><a name="scope"></a><a href="qservicemanager.html#Scope-enum">Scope</a> QServiceManager::scope () const</h3>
<p>Returns the scope used for registering and searching of services.</p>
<h3 class="fn"><a name="serviceAdded"></a>void QServiceManager::serviceAdded ( const QString &amp; <i>serviceName</i>, <a href="qservicemanager.html#Scope-enum">QServiceManager::Scope</a> <i>scope</i> )&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emited whenever a new service with the given <i>serviceName</i> has been registered with the service manager. <i>scope</i> indicates where the service was added.</p>
<p>If the manager scope is <a href="qservicemanager.html#Scope-enum">QServiceManager::SystemScope</a>, it will not receive notifications about services added in the user scope.</p>
<p>See also <a href="qservicemanager.html#addService">addService</a>().</p>
<h3 class="fn"><a name="serviceRemoved"></a>void QServiceManager::serviceRemoved ( const QString &amp; <i>serviceName</i>, <a href="qservicemanager.html#Scope-enum">QServiceManager::Scope</a> <i>scope</i> )&nbsp;&nbsp;<tt> [signal]</tt></h3>
<p>This signal is emited whenever a service with the given <i>serviceName</i> has been deregistered with the service manager. <i>scope</i> indicates where the service was added.</p>
<p>If the manager scope is <a href="qservicemanager.html#Scope-enum">QServiceManager::SystemScope</a>, it will not receive notifications about services removed in the user scope.</p>
<p>See also <a href="qservicemanager.html#removeService">removeService</a>().</p>
<h3 class="fn"><a name="setInterfaceDefault"></a>bool QServiceManager::setInterfaceDefault ( const QString &amp; <i>service</i>, const QString &amp; <i>interfaceName</i> )</h3>
<p>Sets the default interface implementation for <i>interfaceName</i> to the matching interface implementation provided by <i>service</i>.</p>
<p>If <i>service</i> provides more than one interface implementation for <i>interfaceName</i>, the newest version of the interface is set as the default.</p>
<p>Returns true if the operation succeeded, and false otherwise.</p>
<p><b>Note:</b> When in system scope, the <i>service</i> must be a system-wide service rather than a user-specific service; otherwise, this will fail.</p>
<p>See also <a href="qservicemanager.html#interfaceDefault">interfaceDefault</a>().</p>
<h3 class="fn"><a name="setInterfaceDefault-2"></a>bool QServiceManager::setInterfaceDefault ( const <a href="qserviceinterfacedescriptor.html">QServiceInterfaceDescriptor</a> &amp; <i>descriptor</i> )</h3>
<p>This is an overloaded member function, provided for convenience.</p>
<p>Sets the interface implementation specified by <i>descriptor</i> to be the default implementation for the particular interface specified in the descriptor.</p>
<p>Returns true if the operation succeeded, and false otherwise.</p>
<p><b>Note:</b> When in system scope, the <i>descriptor</i> must refer to a system-wide service rather than a user-specific service; otherwise, this will fail.</p>
<p /><address><hr /><div align="center">
<table width="100%" cellspacing="0" border="0"><tr class="address">
<td align="left">Copyright &copy; 2009 Nokia Corporation and/or its subsidiary(-ies)</td>
<td align="right"><div align="right">Qt Service Framework</div></td>
</tr></table></div></address></body>
</html>
